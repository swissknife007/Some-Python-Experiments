<!-- Page: ProblemsetProblemViewPage.ftl --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="675999gf8914heg8effge1c427666e80"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="p1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>
    <meta property="fb:admins" content="100001352546622" />
    <meta property="og:image" content="http://worker.codeforces.ru/static/images/codeforces-vk-square-en.png"/>
    <meta property="og:title" content="Problem - 417D - Codeforces"/>
    <meta property="og:site_name" content="Codeforces"/>
    
    <meta name="cc" content="1tauv8wz1lqhk"/>
    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problem - 417D - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />

    <link rel="stylesheet" href="http://worker.codeforces.ru/static/css/font-awesome.min.css" type="text/css" charset="utf-8" />

        <link href='//fonts.googleapis.com/css?family=Cuprum&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

    <link rel="shortcut icon" type="image/png" href="http://worker.codeforces.ru/static/favicon.png">

    <!--CombineResourcesFilter-->
    <LINK charset="utf-8" href="http://worker.codeforces.ru/static/combine/532a51f3e21ab4661013f28aa2665e53_429c63982abfce9ee19b92499fdeb13f.css" rel="stylesheet" type="text/css"/>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
        
        
        

    <SCRIPT src="http://worker.codeforces.ru/static/combine/89b3ee750b2212159cecc5edcdb53b8e_f93746ca86a88837c9a6a38d1dd41ac.js" type="text/javascript"> </SCRIPT>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="http://worker.codeforces.ru/static/markitup/skins/markitup/style.css" type="text/css" charset="utf-8" />
    <link rel="stylesheet" href="http://worker.codeforces.ru/static/markitup/sets/markdown/style.css" type="text/css" charset="utf-8" />

    <script type="text/javascript" src="//yandex.st/share/share.js" charset="utf-8"></script>
    
    <script type="text/javascript" src="http://worker.codeforces.ru/static/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="http://worker.codeforces.ru/static/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->


</head>
<body><span style='display:none;' class='csrf-token' data-csrf='675999gf8914heg8effge1c427666e80'>&nbsp;</span>
<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function() {
    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = (document.location.protocol == 'https:' ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
        <!-- Frame: Header.ftl -->
<div id="header" style="position:relative;">
    <div style="float:left;">
            <a href="/"><img src="http://worker.codeforces.ru/static/images/codeforces-logo-with-upper-beta.png"/></a>
                <div style="position:absolute;left:147px;top:41px;">
                    <a href="http://vk.com" class="logo-href">Sponsored by <img style="position:relative;top:2px;" src="http://worker.codeforces.ru/static/images/vkontakte-tiny-en.png"/></a>
                </div>

    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="?locale=en"><img src="http://worker.codeforces.ru/static/images/flags/24/gb.png" title="In English" alt="In English"/></a>
            <a href="?locale=ru"><img src="http://worker.codeforces.ru/static/images/flags/24/ru.png" title="По-русски" alt="По-русски"/></a>
        </div>
        <div>
                <a href="/enter">Enter</a>
                 | 
                <a href="/register">Register</a>
                
        </div>
    </div>
    <div style="font-size:0.8em;margin-top:0.25em;position:absolute;right:0;top:4.25em;">
    </div>
    <br style="clear: both;"/>
</div>
<!-- /Frame: Header.ftl -->
        <!-- Frame: MainMenuFrame.ftl -->
    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class="current"><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/help">Help</a></li>
                <li class=""><a href="/coderstrike2014">Coder-Strike <img class="icon" src="http://stat.codeforces.ru/images/icons/cup.png"/></a></li>
                <li class=""><a href="/rcc2014">RCC <img class="icon" src="http://stat.codeforces.ru/images/icons/cup.png"/></a></li>
    </ul>
    <form method="post" action="/search"><input type='hidden' name='csrf_token' value='675999gf8914heg8effge1c427666e80'/>
        <input class="search" name="query" data-isPlaceholder="true" value="Search by tag"/>
    </form>
    <br style="clear: both;"/>
</div>
    </div>
<!-- /Frame: MainMenuFrame.ftl -->
    <script type="text/javascript">
        $(document).ready(function() {
            $("input.search").focus(function() {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        <br style="height: 3em; clear: both;"/>
        <div style="position: relative;">
                    <div id="sidebar"><!-- Frame: ComplexFrame.ftl -->
<!-- Frame: ComplexFrame.ftl --><!-- Frame: ContestStateSidebarFrame.ftl -->
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;"><a style="color: black" href="/contest/417">RCC 2014 Warmup (Div. 2)</a></th>
                </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span class="contest-state-phase">Finished</span></td>
                    </tr>
            </tbody>
        </table>
    </div>
<!-- /Frame: ContestStateSidebarFrame.ftl -->

<!-- Frame: ProblemTagsFrame.ftl -->
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">&rarr; Problem tags
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Bitmasks">
    bitmasks
</span>
    </div>
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Dynamic programming">
    dp
</span>
    </div>
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Greedy algorithms">
    greedy
</span>
    </div>
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Sortings, orderings">
    sortings
</span>
    </div>
    <div style="clear:both;text-align:right;font-size:11px;">
            <span title="Please login into the Codeforces" class="notice">No tag edit access</span>
    </div>
</div>
    </div>

<form id="addTagForm" action="/data/problemTags" method="post" style="display:none;"><input type='hidden' name='csrf_token' value='675999gf8914heg8effge1c427666e80'/>
    <input name="action" type="hidden" value="addTag"/>
    <input name="problemId" type="hidden" value="8548"/>
    <input name="tagName" type="hidden" value=""/>
</form>

<form id="removeTagForm" action="/data/problemTags" method="post" style="display:none;"><input type='hidden' name='csrf_token' value='675999gf8914heg8effge1c427666e80'/>
    <input name="action" type="hidden" value="removeTag"/>
    <input name="problemId" type="hidden" value="8548"/>
    <input name="tagName" type="hidden" value=""/>
</form>

<script type="text/javascript">
    $(".tag-box img").click(function () {
        var tagName = $(this).attr("value");
        Codeforces.confirm("Are you sure you want to remove this tag?", function () {
            $("#removeTagForm input[name=tagName]").val(tagName);
            $("#removeTagForm").submit();
        }, function () {
        }, "Yes", "No");
    });

    $("#addTagLink").click(function () {
        $(this).hide();
        $("#addTagLabel").show();
        return false;
    });

    $("#addTagSelect").change(function () {
        var tagName = $(this).val();
        if (tagName === "") {
            $("#addTagLabel").hide();
            $("#addTagLink").show();
        } else {
            $("#addTagForm input[name=tagName]").val(tagName);
            $("#addTagForm").submit();
        }
    });
</script>
<!-- /Frame: ProblemTagsFrame.ftl --><!-- Frame: ContestResourcesSidebarFrame.ftl -->
<style type="text/css">
#new-resource-form tr td {
padding-top: 0.5em;
}
#new-resource-form input:not([type="submit"]) {
font-size: 0.8em;
}
#new-resource-form select {
font-size: 0.8em;
}
</style>
<div class="roundbox sidebox sidebar-menu" style="">
<div class="roundbox-lt">&nbsp;</div>
<div class="roundbox-rt">&nbsp;</div>
<div class="caption titled">&rarr; Contest materials
<div class="top-links">
</div>
</div>
<ul>
<li>
<span>
<a href="/blog/entry/11730" title="RCC 2014 WarmUp Analysis" target="_blank">Tutorial</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceId="2374" resourceName="RCC 2014 WarmUp Analysis"
resourceManual="true" src="http://worker.codeforces.ru/static/images/icons/close-10x10.png"
style="position: relative;bottom: -1px;left: 1px;cursor: pointer;"/>
</span>
<div style="clear: both;"></div>
</li>
</ul>
</div><!-- /Frame: ContestResourcesSidebarFrame.ftl --><!-- /Frame: ComplexFrame.ftl --><!-- /Frame: ComplexFrame.ftl --></div>
                    <div id="content" class="content-with-sidebar">
                <div class="second-level-menu"><!-- Frame: SecondLevelMenuFrame.ftl -->
<ul class="second-level-menu-list">
        <li class="current"><a
                                        href="/problemset">Problems</a></li>
        <li><a
                                        href="/problemset/submit">Submit</a></li>
        <li><a
                                        href="/problemset/status">Status</a></li>
        <li><a
                                        href="/problemset/standings">Standings</a></li>
        <li><a
                                        href="/problemset/customtest">Custom test</a></li>
</ul>
<!-- /Frame: SecondLevelMenuFrame.ftl --></div>
<!-- Frame: ProblemViewFrame.ftl -->
<div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Cunning Gena</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>A boy named Gena really wants to get to the &quot;Russian Code Cup&quot; finals, or at least get a t-shirt. But the offered problems are too complex, so he made an arrangement with his <span class="tex-span"><i>n</i></span> friends that they will solve the problems for him.</p><p>The participants are offered <span class="tex-span"><i>m</i></span> problems on the contest. For each friend, Gena knows what problems he can solve. But Gena's friends won't agree to help Gena for nothing: the <span class="tex-span"><i>i</i></span>-th friend asks Gena <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> rubles for his help <span class="tex-font-style-bf">in solving all the problems</span> he can. Also, the friend agreed to write a code for Gena only if Gena's computer is connected to at least <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> monitors, each monitor costs <span class="tex-span"><i>b</i></span> rubles.</p><p>Gena is careful with money, so he wants to spend as little money as possible to solve all the problems. Help Gena, tell him how to spend the smallest possible amount of money. Initially, there's no monitors connected to Gena's computer.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span> and <span class="tex-span"><i>b</i></span> (<span class="tex-span">1 ≤ <i>n</i> ≤ 100</span>; <span class="tex-span">1 ≤ <i>m</i> ≤ 20</span>; <span class="tex-span">1 ≤ <i>b</i> ≤ 10<sup class="upper-index">9</sup></span>) — the number of Gena's friends, the number of problems and the cost of a single monitor.</p><p>The following <span class="tex-span">2<i>n</i></span> lines describe the friends. Lines number <span class="tex-span">2<i>i</i></span> and <span class="tex-span">(2<i>i</i> + 1)</span> contain the information about the <span class="tex-span"><i>i</i></span>-th friend. The <span class="tex-span">2<i>i</i></span>-th line contains three integers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>k</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>m</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1 ≤ <i>x</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>; <span class="tex-span">1 ≤ <i>k</i><sub class="lower-index"><i>i</i></sub> ≤ 10<sup class="upper-index">9</sup></span>; <span class="tex-span">1 ≤ <i>m</i><sub class="lower-index"><i>i</i></sub> ≤ <i>m</i></span>) — the desired amount of money, monitors and the number of problems the friend can solve. The <span class="tex-span">(2<i>i</i> + 1)</span>-th line contains <span class="tex-span"><i>m</i><sub class="lower-index"><i>i</i></sub></span> distinct positive integers — the numbers of problems that the <span class="tex-span"><i>i</i></span>-th friend can solve. The problems are numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>m</i></span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the minimum amount of money Gena needs to spend to solve all the problems. Or print -1, if this cannot be achieved.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 2 1<br />100 1 1<br />2<br />100 2 1<br />1<br /></pre></div><div class="output"><div class="title">Output</div><pre>202<br /></pre></div><div class="input"><div class="title">Input</div><pre>3 2 5<br />100 1 1<br />1<br />100 1 1<br />2<br />200 1 2<br />1 2<br /></pre></div><div class="output"><div class="title">Output</div><pre>205<br /></pre></div><div class="input"><div class="title">Input</div><pre>1 2 1<br />1 1 1<br />1<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br /></pre></div></div></div></div></div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");
        if (endsWith(titleDiv.text(), "(logic puzzle)")) {
            titleDiv.html(titleDiv.html()
                    + "<sup style=\"padding-left: 0.5em;\">"
                    + "<a style='text-decoration: none; background-color: white' href=\"/contest/417/rules#logicPuzzle\">"
                    + "<i style='font-style: normal; color: #222;' class=\"icon-question-sign\"></i></a></sup>");
        }

        if (endsWith(titleDiv.text(), "(programming task)")) {
            titleDiv.html(titleDiv.html()
                    + "<sup style=\"padding-left: 0.5em;\">"
                    + "<a style='text-decoration: none; background-color: white' href=\"/contest/417/rules#programmingTask\">"
                    + "<i style='font-style: normal; color: #222;' class=\"icon-question-sign\"></i></a></sup>");
        }


    });
</script>
<!-- /Frame: ProblemViewFrame.ftl -->            </div>
        </div>
<!-- Frame: Footer.ftl -->
<br style="clear: both;"/>
<div id="footer">
    <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2014 Mike Mirzayanov</div>
    <div>The only programming contests Web 2.0 platform</div>
    <div>Server time: 04/22/2014 12:41PM (p1).</div>
</div>
<!-- /Frame: Footer.ftl -->    <script type="text/javascript">
        $(document).ready(function() {
            Codeforces.focusOnError();
        });
    </script>
</div>
</body>
</html>
<!-- /Page: ProblemsetProblemViewPage.ftl -->